<odoo>
    <record id="view_order_form_inherit_contract_tab" model="ir.ui.view">
        <field name="name">sale.order.form.inherit.contract.tab</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="industry_real_estate.rental_form_view"/>
        <field name="arch" type="xml">

        <!-- Hacer visible y renombrar la pestaña nativa -->
        <xpath expr="//page[@name='customer_signature']" position="attributes">
            <attribute name="groups"/>
            <attribute name="invisible">0</attribute>
            <attribute name="string">Firmar documento</attribute>
        </xpath>

        <!-- REEMPLAZA SOLO EL CONTENIDO de la pestaña -->
        <xpath expr="//page[@name='customer_signature']/*" position="replace">
            <group class="alert alert-info" string="¡Para tener en cuenta!" role="status">
                <group><p>A continuación, está el instructivo del nombre que debe tener el archivo, para guardar el documento que se debe firmar, según corresponda al estado del contrato.</p>
                <ul><li><strong>Contrato (El sistema lo carga automáticamente): </strong>contrato.pdf</li>
                    <li><strong>Acta de entrega: </strong>acta_de_entrega.pdf</li>
                    <li><strong>Paz y salvo entrega: </strong>paz_y_salvo_entrega.pdf</li>
                    <li><strong>Acta de recepcion: </strong>acta_de_recepcion.pdf</li>
                    <li><strong>Paz y salvo recepcion: </strong>paz_y_salvo_recepcion.pdf</li>
                    <li><strong>Acta de finalizacion: </strong>acta_de_finalizacion.pdf</li>
                </ul></group>
                <group class="alert alert-warning" string="NOTA" role="status"><p>Las plantillas de contrato deben ser cargadas previamente en <strong>"Configuración" - "Cargar documentos y fimas"</strong> en el menú superior.</p></group>
            </group>
            <group>
            <!-- <field name="contract_id" options="{'no_create': True}"/> -->
            <button name="action_request_signature_from_order"
                    type="object" class="btn-primary"
                    string="Solicitar firma"
                    modifiers="{'invisible': [('contract_id','=', False)]}"
                    context="{
                        'from_sale_order': True,
                        'so_partner_id': partner_id,
                        'so_partner_invoice_id': partner_lessor_id,
                        'so_partner_shipping_id': x_guarant_partner_id
                    }"/>
            </group>

            <!-- TODO lo de sign.request DEBE ir dentro de este field -->
            <field name="contract_sign_request_ids" nolabel="1" readonly="1"
                context="{'default_x_contract_id': contract_id}">
            <list create="0" delete="0">
                <field name="reference"/>
                <field name="state"/>
            </list>
            <form>
                <sheet>
                <group>
                    <field name="reference" readonly="1"/>
                    <field name="state" readonly="1"/>
                </group>
                </sheet>
            </form>
            </field>
        </xpath>

        <!-- Smart button en el button_box -->
        <xpath expr="//div[@name='button_box']" position="inside">
            <button class="oe_stat_button"
                    name="action_view_signed_docs"
                    type="object"
                    modifiers="{'invisible':[('contract_id','=',False)]}">
            <field name="sign_request_count" widget="statinfo" string="Firmas"/>
            </button>
        </xpath>

        </field>
    </record>
</odoo>
